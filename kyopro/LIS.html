<!DOCTYPE html>

<html lang="ja">

<head>
	<meta charset="UTF-8">
	<title>Zobio's blog - 最長増加部分列</title>
	<link rel="icon" href="https://zobio.github.io/test.ico">
</head>

<header>
	<a href="https://zobio.github.io"> <img src="https://zobio.github.io/logo.jpg" width="20%" height="20%"> </a>
</header>

<body>
	<div class="title">
		<h3>2021/5/30</h3>
		<h1>最長増加部分列</h1>
	</div>
	<hr>
	<div class="main">
		<P>
			問題例
		</P>
		<p>
			数列aから好きな整数を好きなだけ取り除き、単調増加な数列を作るとき、その数列の長さの最大値を求めなさい。
		</p>
		<p>
			引用: <a href="https://atcoder.jp/contests/chokudai_S001/tasks/chokudai_S001_h">https://atcoder.jp/contests/chokudai_S001/tasks/chokudai_S001_h</a>
		</p>
		<br>
		<p>
			最初に考えたこと
		</p>
		<p>
			dp[i].first ... i - 1番目までの中からできる最長の単調増加数列の長さ<br>
			dp[i].second ... その時の数列内の最大値<br>
			として、Nの1重ループでdpの値を更新していく
		</p>
		<br>
		<p>
			実際に書いたコード
		</p>
		<object type="text/plain" data="5_30_3.cpp" height="100%" width="100%"> </object>
		<br>
		<p>
			反例
		</p>
		<p>
			N = 20<br>
			a = {19 11 10 7 8 9 17 18 20 4 3 15 16 1 5 14 6 2 13 12}
		</p>
		<p>
			先ほどのコードだと、最初の19を必ず選んでしまい、19, 20だけしか選べずに長さが2になってしまう(答えは6)。
		</p>
		<br>
		<p>
			正しい解法
		</p>
		<p>
			最長増加部分列を下記のような方法で動的に作っていく。
		</p>
		<p>
			dp[i] ... 長さがi + 1であるよな増加部分列における最終要素の最小値(存在しない場合はINF)
		</p>
		<p>
			dpの更新方法は、
		</p>
		<ul>
			<li>
				a[i]がdp[j](jはdp[j]がINFでない最大の数)よりも大きいとき、dp[j + 1] = a[i]
			</li>
			<li>
				a[i]がdp[j]よりも小さいとき、dp[k] = a[i] (kはdp[k] < a[i]となる最大の数)
			</li>
		</ul>
		<p>
			であり、以下のコードのように書ける。
		</p>
		<object type="text/plain" data="5_30_5.cpp" height="100%" width="100%"> </object>
	</div>
	<br><br>
</body>

</html>